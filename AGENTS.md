# AGENTS.md

Behavioral guidelines for this repository.

## Behavioral Guidelines

- **Think before coding:** State assumptions explicitly. Ask if unclear.
- **Simplicity first:** Minimum code that solves the problem. No speculative features.
- **Surgical changes:** Touch only what you must. Don't "improve" unrelated code.
- **Goal-driven:** Define success criteria before implementing.

---

## Project Overview

This repository contains recipes for building C libraries. Each recipe has:
- `library.toml` - metadata (title, version, license, dependencies, recipe_url)
- `install.sh` - installation script

The build system generates HTML documentation from these recipes.

## Build Commands

```bash
make all    # Validates TOML schema + canonical names + builds all HTML files
```

**Never generate HTML files locally.** Only generate them within GitHub Actions. Keep generated HTML files (.html) out of git commits.

## Code Style

### Python
- Stdlib only (`tomllib`, `subprocess`, `os`, `pathlib`, `sys`)
- 4-space indentation, 88-char max line length
- Use f-strings, explicit imports, type hints where beneficial

### Shell
- Use `#!/bin/bash` or `#!/usr/bin/env bash`
- Always use `set -e` for error handling
- Quote variables: `"$VAR"`, use `${VAR}` in strings

### TOML Recipe Files
```toml
title = "PackageName"
version = "1.0.0"
description = "One-line description."
license = "LicenseName"
dependencies = "Required deps or 'None'"
recipe_url = "https://..."
canonical_name = "PackageName"
```
- Use double quotes, keep description under 200 chars

## Directory Structure

```
recipes/
├── build.py                    # TOML + template -> HTML
├── check_canonical_names.py    # Validate unique names
├── check_toml_schema.py        # Validate TOML schema
├── generate_packages.py        # Generate packages.json
├── Makefile                    # Build orchestrator
├── AGENTS.md                   # This file
├── index.md, about.md          # Page sources
├── packages.json               # Generated package list
├── LICENSE, README.md, .gitignore
├── templates/
│   └── template.html           # HTML template
├── docs/                       # Generated output (deployed)
├── recipes/                    # Library recipes
│   └── [letter]/
│       └── [library-name]/
│           ├── library.toml
│           └── install.sh
└── .github/
    └── workflows/
        ├── build.yml           # Build & deploy to GitHub Pages
        └── check.yml           # Validate TOML on PRs
```

## Common Tasks

### Adding a New Recipe
1. Create `recipes/<letter>/<name>/`
2. Add `library.toml` with metadata
3. Add `install.sh` with build script
4. Commit (HTML generated by CI)
